<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Hydration Pro Clinical — Smart Web</title>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J656JXPX83"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-J656JXPX83');
</script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Almarai:wght@700;900&display=swap');

body {
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: radial-gradient(circle at bottom center, #00ffff 0%, #0500aa 40%, #000000 100%);
  font-family:'Almarai', sans-serif;
  color:#00ffff;
  padding:10px;
  box-sizing:border-box;
}

.container {
  background: rgba(0,0,0,0.25);
  border-radius: 25px;
  box-shadow: 0 0 20px 6px aqua, 0 0 40px 14px #00ffffaa;
  width: 100%;
  max-width: 700px;
  height: 75vh;
  overflow:hidden;
  display:flex;
  flex-direction: column;
  padding: 20px;
  box-sizing:border-box;
}

.inner-container {
  padding: 10px;
  overflow-y: auto;
  height: 100%;
  scrollbar-width: none;
}

.inner-container::-webkit-scrollbar { width:0; }

.question, .result-card, .schedule-card {
  margin-bottom:15px;
  font-size:1rem;
  display:flex;
  flex-direction: column;
  transform: translateY(20px);
  opacity:0;
  transition: all 0.4s ease;
}

.question.show, .result-card.show, .schedule-card.show {
  transform: translateY(0);
  opacity:1;
}

.input-container {
  position: relative;
  width: 100%;
}

.input-container input,
.input-container select {
  padding: 12px 10px;
  width: 100%;
  border-radius: 8px;
  border: 2px solid #00ffff;
  background: rgba(0,0,0,0.25);
  color: #00ffff;
  font-size: 1rem;
  outline: none;
  box-sizing: border-box;
}

.input-container input::placeholder {
  color: rgba(0,255,255,0.6);
  font-size:0.9rem;
}

.input-container select option {
  background: #000;
  color: #00ffff;
}

.input-container label {
  position: absolute;
  top: 50%;
  left: 10px;
  transform: translateY(-50%);
  color: rgba(0,255,255,0.6);
  font-size: 0.9rem;
  pointer-events: none;
  transition: 0.3s ease all;
}

.input-container input:focus + label,
.input-container input:not(:placeholder-shown) + label,
.input-container select:focus + label,
.input-container select:not([value=""]) + label {
  top: -10px;
  font-size: 0.75rem;
  color: #00ffff;
  background: rgba(0,0,0,0.25);
  padding: 0 5px;
}

.input-container input:focus,
.input-container select:focus {
  border-color:#fff;
  box-shadow:0 0 10px #00ffff;
}

.result-card, .schedule-card {
  background: rgba(0,0,0,0.4);
  border-radius:15px;
  padding:15px;
  font-size:1rem;
  line-height:1.5;
}

/* Media Queries للشاشات الصغيرة */
@media (max-width:480px) {
  .container {
    height: auto;
    padding: 15px;
  }
  .question, .result-card, .schedule-card {
    font-size: 0.9rem;
  }
  .input-container input,
  .input-container select {
    font-size: 0.9rem;
    padding: 10px 8px;
  }
}
</style>
</head>
<body>
<div class="container">
  <div class="inner-container" id="questionContainer"></div>
</div>

<script>
// ==================== أسئلة المستخدم ====================
const questions = [
  {text:"العمر (سنوات)", type:"number", min:1, max:120},
  {text:"الجنس", type:"select", options:["ذكر","انثى"]},
  {text:"الوزن (كجم)", type:"number", min:10, max:300},
  {text:"الطول (سم)", type:"number", min:50, max:250},
  {text:"نسبة الدهون في الجسم (%)", type:"number", min:0, max:70, default:0},
  {text:"نوع الرياضة", type:"select", options:["جري","كارديو","قوة","hiit","سباحة","مختلط","آخرى"], default:"مختلط"},
  {text:"عدد أيام التدريب أسبوعيًا", type:"number", min:0, max:14, default:3},
  {text:"متوسط مدة التمرين (دقيقة)", type:"number", min:0, max:300, default:45},
  {text:"شدة التمرين (RPE 1-10)", type:"number", min:1, max:10, default:6},
  {text:"هل تستطيع قياس التعرق؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"الوزن قبل التمرين (كجم)", type:"number", min:10, max:300, condition:(a)=>a[9]==="نعم"},
  {text:"الوزن بعد التمرين (كجم)", type:"number", min:10, max:300, condition:(a)=>a[9]==="نعم"},
  {text:"مدة التمرين عند القياس (دقيقة)", type:"number", min:1, max:300, condition:(a)=>a[9]==="نعم"},
  {text:"كم لتر شربت أثناء التمرين؟", type:"number", min:0, max:5, step:0.1, default:0, condition:(a)=>a[9]==="نعم"},
  {text:"هل لديك تحاليل دم/بول حديثة؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"مستوى الصوديوم في الدم (mmol/L)", type:"number", min:120, max:160, condition:(a)=>a[14]==="نعم"},
  {text:"أسمولية البول (mOsm/kg)", type:"number", min:0, max:1500, condition:(a)=>a[14]==="نعم"},
  {text:"كرياتينين (mg/dL)", type:"number", min:0, max:20, condition:(a)=>a[14]==="نعم"},
  {text:"هل تتناول مدرات بول؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"أسماء أدوية مهمة أخرى", type:"text"},
  {text:"مكملات تتناولها", type:"text"},
  {text:"كم ملليلتر من الكافيين يوميًا؟", type:"number", min:0, max:1000, default:0},
  {text:"كم لتر من المشروبات الرياضية/الإلكترولايت يوميًا؟", type:"number", min:0, max:5, default:0},
  {text:"كم لتر ماء عادي تشرب يوميًا تقريبًا؟", type:"number", min:0, max:5, default:1},
  {text:"نسبة الفواكه والخضار من النظام الغذائي (%)", type:"number", min:0, max:100, default:30},
  {text:"كم وجبة مالحة/مصنّعة يوميًا؟", type:"number", min:0, max:10, default:1},
  {text:"درجة الحرارة المحيطة (°م)", type:"number", min:-10, max:60, default:25},
  {text:"نسبة الرطوبة (%)", type:"number", min:0, max:100, default:50},
  {text:"التمرين في الهواء الطلق؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"كم ساعة تنام ليلًا؟", type:"number", min:0, max:12, default:7},
  {text:"هل تستيقظ عطشانًا ليلًا؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"مرحلة الدورة (إناث فقط)", type:"select", options:["حيض","بويضة","لا","غير_مطبق"], condition:(a)=>a[1]==="انثى", default:"لا"},
  {text:"هل تصوم حاليًا؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"لون البول صباحًا/بعد التمرين", type:"select", options:["شفاف","فاتح","غامق"], default:"فاتح"},
  {text:"كم مرة تتبول يوميًا؟", type:"number", min:0, max:20, default:6},
  {text:"هل تتبول ليلًا؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"أعراض جفاف (صداع/تعب/تشنجات)؟", type:"select", options:["نعم","لا"], default:"لا"},
  {text:"متوسط معدل ضربات القلب أثناء التمرين (BPM)", type:"number", min:0, max:220, default:0},
  {text:"وقت الاستيقاظ (HH:MM)", type:"time", default:"06:00"},
  {text:"وقت النوم (HH:MM)", type:"time", default:"22:30"}
];

// ==================== عرض الأسئلة ====================
const container = document.getElementById('questionContainer');
let answers = [];
let lastAnsweredIndex = -1;

function createQuestionElement(obj, index){
  const div = document.createElement('div');
  div.classList.add('question');
  const wrapper = document.createElement('div');
  wrapper.classList.add('input-container');

  let input;
  if(obj.type==="select"){
    input = document.createElement('select');
    const placeholder = document.createElement('option');
    placeholder.value = "";
    placeholder.disabled = true;
    placeholder.selected = true;
    placeholder.textContent = obj.text;
    placeholder.style.color = "rgba(0,255,255,0.6)";
    input.appendChild(placeholder);
    obj.options.forEach(opt=>{
      const option = document.createElement('option');
      option.value = opt;
      option.textContent = opt;
      input.appendChild(option);
    });
    input.addEventListener('change', handleSelect);
  } else {
    input = document.createElement('input');
    input.type = obj.type==="time"?"time":obj.type;
    input.placeholder = obj.text;
    if(obj.type==="time"){
        input.addEventListener('change', handleTimeChange);
    } else {
        input.addEventListener('keypress', handleEnter);
    }
    if(obj.default!==undefined) input.value=obj.default;
  }

  input.setAttribute('data-index', index);
  wrapper.appendChild(input);
  div.appendChild(wrapper);
  return div;
}

function validateInput(value, obj){
  if(obj.type==="number") {
    const num=parseFloat(value);
    if(isNaN(num)) return false;
    if(obj.min!==undefined && num<obj.min) return false;
    if(obj.max!==undefined && num>obj.max) return false;
  }
  if(obj.type==="select") return obj.options.includes(value);
  if(obj.type==="time") return /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(value.trim());
  return true;
}

function handleEnter(e){
  if(e.key==='Enter'){
    const idx=parseInt(e.target.getAttribute('data-index'));
    const q=questions[idx];
    const val=e.target.value;
    if(!validateInput(val,q)){
      alert("⚠️ إدخال غير صالح.");
      e.target.focus();
      return;
    }
    answers[idx]=val;
    if(idx>lastAnsweredIndex){
      lastAnsweredIndex=idx;
      nextQuestion(idx);
    }
  }
}

function handleSelect(e){
  const idx=parseInt(e.target.getAttribute('data-index'));
  const val=e.target.value;
  answers[idx]=val;
  if(idx>lastAnsweredIndex){
    lastAnsweredIndex=idx;
    nextQuestion(idx);
  }
}

function handleTimeChange(e){
  const idx = parseInt(e.target.getAttribute('data-index'));
  const val = e.target.value;
  if(!validateInput(val, questions[idx])){
      alert("⚠️ إدخال غير صالح.");
      e.target.focus();
      return;
  }
  answers[idx] = val;
  if(idx > lastAnsweredIndex){
      lastAnsweredIndex = idx;
      nextQuestion(idx);
  }
}

function nextQuestion(idx){
  let nextIndex=idx+1;
  while(nextIndex<questions.length){
    const nextQ=questions[nextIndex];
    if(!nextQ.condition || nextQ.condition(answers)) break;
    nextIndex++;
  }
  if(nextIndex<questions.length){
    const nextElem=createQuestionElement(questions[nextIndex],nextIndex);
    container.appendChild(nextElem);
    setTimeout(()=>nextElem.classList.add('show'),50);
    nextElem.querySelector('input,select').focus();
    nextElem.scrollIntoView({behavior:'smooth', block:'end'});
  } else {
    showResult();
  }
}

const firstQ=createQuestionElement(questions[0],0);
container.appendChild(firstQ);
setTimeout(()=>firstQ.classList.add('show'),50);
firstQ.querySelector('input,select').focus();

// ==================== الحساب ====================
function showResult(){
  let user={};
  questions.forEach((q,i)=>{user[i]=answers[i];});

  let base = parseFloat(user[2]*0.033*0.94);
  if(user[4] && parseFloat(user[4])<15) base+=base*0.05;
  if(user[1]==="انثى") base-=base*0.10;
  if(user[0]>40) base+=0.05;

  base += (parseFloat(user[6]||3)*0.2)+((parseFloat(user[7]||45)/60)*0.8);
  if(parseFloat(user[8]||6)>7 || parseFloat(user[44]||0)>150) base*=1.12;

  if(user[9]==="نعم" && user[10] && user[11]){
    let sweat=(parseFloat(user[10])-parseFloat(user[11]))+parseFloat(user[13]||0);
    base += sweat*(parseFloat(user[6]||3)/7);
  }

  if(parseFloat(user[22]||0)>400) base+=0.2;
  if(user[19]==="نعم") base+=0.7;
  if(user[20] && user[20].toLowerCase().includes("creat")) base+=0.25;
  if(parseFloat(user[29]||7)<7 || user[30]==="نعم") base+=0.2;
  if(user[34]==="غامق") base+=0.5;
  if(user[36]==="نعم") base+=0.4;

  base=Math.max(2.0, Math.min(base,6.0));
  base=Math.round(base*100)/100;

  const div=document.createElement('div');
  div.classList.add('result-card');
  div.innerHTML=`<strong>💧 الترطيب اليومي المقدر:</strong> ${base} لتر/يوم`;
  container.appendChild(div);
  setTimeout(()=>div.classList.add('show'),50);
  div.scrollIntoView({behavior:'smooth', block:'end'});

  const wake_time=user[45]||"06:00";
  const sleep_time=user[46]||"22:30";
  let total_ml = base*1000;
  const wake_dt=new Date(); wake_dt.setHours(parseInt(wake_time.split(":")[0]),parseInt(wake_time.split(":")[1]),0,0);
  const sleep_dt=new Date(); sleep_dt.setHours(parseInt(sleep_time.split(":")[0]),parseInt(sleep_time.split(":")[1]),0,0);
  if(sleep_dt<wake_dt) sleep_dt.setDate(sleep_dt.getDate()+1);
  const total_minutes=(sleep_dt-wake_dt)/60000;

  const windows = [
    ["استيقاظ",0.20], ["تحضير الصباح",0.06], ["إفطار",0.14], ["سناك صباحي",0.06],
    ["غداء",0.14], ["سناك بعد الظهر",0.09], ["قبل التمرين",0.06],
    ["أثناء التمرين",0.14], ["بعد التمرين",0.09], ["عشاء",0.11], ["سناك مسائي",0.05],
    ["قبل النوم",0.05]
  ];

  let scheduleDiv=document.createElement('div');
  scheduleDiv.classList.add('schedule-card');
  scheduleDiv.innerHTML="<strong>🕒 جدول الترطيب اليومي:</strong><br>";
  let current_time = new Date(wake_dt);
  const interval = total_minutes/windows.length;

  windows.forEach(w=>{
    const t = new Date(current_time);
    const ml=Math.round(total_ml*w[1]);
    scheduleDiv.innerHTML+=`${t.getHours().toString().padStart(2,'0')}:${t.getMinutes().toString().padStart(2,'0')} | ${w[0]} | ${ml} ml<br>`;
    current_time.setMinutes(current_time.getMinutes()+interval);
  });

  container.appendChild(scheduleDiv);
  setTimeout(()=>scheduleDiv.classList.add('show'),50);
  scheduleDiv.scrollIntoView({behavior:'smooth', block:'end'});
}
</script>
</body>
</html>

